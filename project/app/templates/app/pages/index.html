{% extends 'app/pages/base.html' %}
{% load cloudinary %}
{% load static %}
{% load humanize %}
{% load app_tags %}

{% block metatags %}
  <meta property="og:title" content="Make Masks Optional Next School Year" />
  <meta property="og:image" content='{% static "app/wide_logo.jpg" %}' />
  <meta property="og:image:secure_url" content='{% static "app/wide_logo.jpg" %}' />
  <meta property="og:url" content="https://www.smilewestada.com" />
  <meta property="og:type" content="website" />
  <meta property="fb:app_id" content="286973936371350" />
  <meta property="og:description" content="Smile West Ada is a group of parents who want masks optional next year.  Join today so we can speak with one, clear, powerful voice.  The site is free, we protect your privacy, and we don't have an agenda beyond seeing all those smiles in West Ada classrooms next year." />
{% endblock metatags %}

{% block customstyles %}
  <link href="https://unpkg.com/cloudinary-video-player/dist/cld-video-player.min.css" rel="stylesheet">
{% endblock customstyles %}


{% block title %}{% endblock title%}

{% block content %}
  <section class 'mt-5'>

    <div id='id_wistia'>
      <script src="https://fast.wistia.com/embed/medias/roh1r7kene.jsonp" async></script><script src="https://fast.wistia.com/assets/external/E-v1.js" async></script><div class="wistia_responsive_padding" style="padding:56.25% 0 0 0;position:relative;"><div class="wistia_responsive_wrapper" style="height:100%;left:0;position:absolute;top:0;width:100%;"><span class="wistia_embed wistia_async_roh1r7kene popover=true popoverAnimateThumbnail=true videoFoam=true" style="display:inline-block;height:100%;position:relative;width:100%">&nbsp;</span></div></div>
    </div>

    <div class='jumbotron'>
      <div class='mb-3'>
          <div class='mb-3 mx-3'>
            <p>
              On Tuesday June 15, the West Ada School Board voted 5-0 to make masks optional for the 2021-2022 school year.  Thank you to everyone who made this possible!
            </p>
            <p>
              As promised, now that our mission is accomplished we'll be decommissioning this site and deleting all data within the week.   However, if you wish to continue to stay active please considering joining the <a href='https://www.westadaparents.com'>West Ada Parents Association</a>, a new organization created for those who wish to stay updated and involved in the District.
            </p>
            <p>
              We couldn't have done this without your support.  On behalf of all the students in West Ada, <strong>Thank You!</strong>
            </p>
          </div>
      </div>
      {% comment %}
      <div class='mt-3'>
        <a href='{% url "join" %}' class="btn btn-success btn-block btn-lg p-3">
          <strong>Click Here to Join, Post Comments, and Stay Informed</strong>
        </a>
      </div>
      {% endcomment %}
    </div>
  </section>
  {% comment %}
  <section class='m-3'>
    <table class='table'>
      <thead>
        <tr class='row'>
          <th scope='col' class='col-5'>Name</th>
          <th scope='col' class='col-7'>Comments</th>
        </tr>
      </thead>
      <tbody>
        {% for comment in comments %}
          <tr class='row'>
            <td class='col-5'>
              {{comment.account.name}}<br>
              <ul class='list-inline'>
                {% if comment.account.role == 1 %}
                  <li class='list-inline-item'>
                      <span class="badge badge-warning">Parent</span>
                  </li>
                {% elif comment.account.role == 2 %}
                  <li class='list-inline-item'>
                      <span class="badge badge-success">Student</span>
                  </li>
                {% elif comment.account.role == 3 %}
                  <li class='list-inline-item'>
                      <span class="badge badge-danger">Teacher</span>
                  </li>
                {% endif %}
                {% if comment.account.is_voter %}
                  <li class='list-inline-item'>
                      <span class="badge badge-primary">Registered Voter</span>
                  </li>
                {% endif %}
                {% if comment.account.zone %}
                  <li class='list-inline-item'>
                    <span class="badge badge-light">{{account.get_zone_display}}</span>
                  </li>
                {% endif %}
              </ul>
            </td>
            <td class='col-7'>
              {% if comment.polymorphic_ctype.name == 'Written Comment' %}
                {% if comment.wordcount < 31 %}
                  {{comment.text}}
                {% else %}
                  <div class="collapse show" id="comment-{{comment.id}}">
                    {{comment.text|truncatewords:30}}
                  </div>
                  <div class="collapse" id="comment-{{comment.id}}">
                    {{comment.text}}
                  </div>
                  <a data-toggle="collapse" href="#comment-{{comment.id}}"><small>more</small></a>
                {% endif %}
              {% else %}
                <video
                  id="comment-player"
                  controls
                  class="cld-video-player"
                  data-cld-public-id="{{comment.video.name}}"
                >
                </video>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  {% endcomment %}
{% endblock content %}

{% block scripts %}
  <script src="https://unpkg.com/cloudinary-core/cloudinary-core-shrinkwrap.min.js" type="text/javascript"></script>
  <script src="https://unpkg.com/cloudinary-video-player/dist/cld-video-player.min.js" type="text/javascript"></script>
  <script>
    let cloudName = '{% get_env_var "CLOUDINARY_NAME"%}';
    let cld = cloudinary.Cloudinary.new({
      cloud_name: cloudName
    });
    let  players = cld.videoPlayers('.cld-video-player', {
      showLogo: false,
      sourceTypes: ['hls', 'dash'],
      sourceTransformation: {
        'hls': [{ streaming_profile: 'hd' }],
        'dash': [{ streaming_profile: 'hd' }],
      }
    });
  </script>
  {% comment %}
  <script>
    function animateValue(obj, start, end, duration) {
      let startTimestamp = null;
      const step = (timestamp) => {
        if (!startTimestamp) startTimestamp = timestamp;
        const progress = Math.min((timestamp - startTimestamp) / duration, 1);
        obj.innerHTML = Math.floor(progress * (end - start) + start);
        if (progress < 1) {
          window.requestAnimationFrame(step);
        }
      };
      window.requestAnimationFrame(step);
    }

    const obj = document.getElementById("value");
    animateValue(obj, 0, {{count}}, 5000);
  </script>
  {% endcomment %}
{% endblock scripts %}
