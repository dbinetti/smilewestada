{% extends 'app/pages/base.html' %}

{% load bootstrap4 %}
{% load humanize %}

{% block formmedia %}
  {{ form.media }}
  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v10.0&appId=286973936371350&autoLogAppEvents=1" nonce="BVurEf1h"></script>
{% endblock formmedia %}

{% block title %}Account Page{% endblock title %}

{% block content %}
  <section class='mt-5'>
    <h2 class='my-3 col-md-12'>
      Account
    </h2>
    <p class='lead col-md-8'>
      Review/Update your Account Information Below
    </p>
  </section>
  <section class='mt-5 col-md-8'>
    <form method='post'>
      {% csrf_token %}
      <div class='card'>
        <h4 class='card-header'>Personal Profile</h4>
        <div class="card-body">
          <div class='card-title'>
            <p>
              Keep your profile up to date to maximize your voice.
            </p>
          </div>
          <div class='card-text'>
              {% bootstrap_form_errors form %}
              {% bootstrap_field form.name show_help=True show_label=False placeholder="Name" %}
              {% bootstrap_field form.role show_help=True show_label=False %}
              {% bootstrap_field form.is_public show_help=True show_label=False %}
              {% bootstrap_field form.zone show_help=True show_label=False %}
              {% bootstrap_field form.is_voter show_help=True show_label=False %}
          </div>
        </div>
        <div class='card-footer'>
          {% bootstrap_button "Save" button_type='submit' size='large' %}
          {% bootstrap_button "Cancel" button_type='link' href="/account" size='large' button_class='btn-outline-dark' extra_classes='ml-3'%}
        </div>
      </form>
    </div>
    <div class='text-right'>
      <a href='{% url "delete" %}'><span class='text-danger text-small'>Delete Account</span></a>
    </div>
  </section>
  <section class='mt-5 col-md-8'>
    <div class='card'>
      <h4 class='card-header'>
        Public Comments
      </h4>
      <div class="card-body">
        <div class='card-title'>
          <p>
            These are your public comments.
          </p>
        </div>
        <div class='card-text'>
          <table class='table'>
            <thead>
              <tr>
                <th>Comment</th>
                <th>Status</th>
                <th>Delete</th>
              </tr>
            </thead>
            <tbody>
              {% for comment in comments %}
                <tr>
                  {% if comment.polymorphic_ctype.name == 'Written Comment' %}
                    <td>
                      {{comment.text}}
                    </td>
                  {% else %}
                    <td>
                      <img src={{comment.video.url}}.jpg class='img-fluid pb-3'>
                    </td>
                  {% endif %}
                  <td>
                    {{ comment.get_state_display }}
                  </td>
                  <td>
                    <a href='{% url "comment-delete" comment.id %}'><span class='text-danger'>Delete</span></a>
                  </td>
                </tr>
              {% empty %}
                <tr>
                  <td colspan=3>
                    (No Public Comments)
                  <td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
      <div class='card-footer'>
        <div class='list-inline'>

        {% url 'submit-spoken-comment' as spoken_url_comment %}
        <li class='list-inline-item'>{% bootstrap_button "Make Spoken Comment" button_type='link' href=spoken_url_comment size='large' button_class='btn-primary' extra_classes='m-2'%}</li>
        {% url 'submit-written-comment' as written_url_comment %}
        <li class='list-inline-item'>{% bootstrap_button "Make Written Comment" button_type='link' href=written_url_comment size='large' button_class='btn-success' extra_classes='m-2'%}</li>
      </div>
    </div>
  </section>
{% endblock content %}
